!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common"],t):t(e["angular2-qrscanner"]={},e.ng.core,e.ng.common)}(this,function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.count=1,this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r/this.estimatedModuleSize<=1}return!1},this.x=e,this.y=t,this.estimatedModuleSize=n}return Object.defineProperty(e.prototype,"EstimatedModuleSize",{get:function(){return this.estimatedModuleSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Count",{get:function(){return this.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"X",{get:function(){return Math.floor(this.x)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Y",{get:function(){return Math.floor(this.y)},enumerable:!0,configurable:!0}),e}(),i=function(){return function(e,t,n,i,o,s,a,h,u){this.possibleCenters=new Array,this.crossCheckStateCount=new Array(0,0,0),this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;r<3;r++)if(Math.abs(t-e[r])>=n)return!1;return!0},this.crossCheckVertical=function(e,t,n,r){var i=this.image,o=this.imageHeight,s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var a=e;a>=0&&i[t+a*this.imageWidth]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&!i[t+a*this.imageWidth]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i[t+a*this.imageWidth]&&s[1]<=n;)s[1]++,a++;if(a==o||s[1]>n)return NaN;for(;a<o&&!i[t+a*this.imageWidth]&&s[2]<=n;)s[2]++,a++;if(s[2]>n)return NaN;var h=s[0]+s[1]+s[2];return 5*Math.abs(h-r)>=2*r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN},this.handlePossibleCenter=function(e,t,n){var i=e[0]+e[1]+e[2],o=this.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(o),2*e[1],i);if(!isNaN(s)){for(var a=(e[0]+e[1]+e[2])/3,h=this.possibleCenters.length,u=0;u<h;u++)if(this.possibleCenters[u].aboutEquals(a,s,o))return new r(o,s,a);var f=new r(o,s,a);this.possibleCenters.push(f),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(f)}return null},this.find=function(){for(var e=this.startX,t=this.height,n=e+this.width,r=this.startY+(t>>1),i=new Array(0,0,0),o=0;o<t;o++){var s=r+(0==(1&o)?o+1>>1:-(o+1>>1));i[0]=0,i[1]=0,i[2]=0;for(var a=e;a<n&&!this.image[a+this.imageWidth*s];)a++;for(var h=0;a<n;){if(this.image[a+s*this.imageWidth])if(1==h)i[h]++;else if(2==h){var u;if(this.foundPatternCross(i)&&null!=(u=this.handlePossibleCenter(i,s,a)))return u;i[0]=i[2],i[1]=1,i[2]=0,h=1}else i[++h]++;else 1==h&&h++,i[h]++;a++}if(this.foundPatternCross(i)&&null!=(u=this.handlePossibleCenter(i,s,n)))return u}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"},this.image=e,this.startX=t,this.startY=n,this.width=i,this.height=o,this.moduleSize=s,this.resultPointCallback=u,this.imageWidth=a,this.imageHeight=h}}(),o=function(){function e(e,t){if(t||(t=e),e<1||t<1)throw"Both dimensions must be greater than 0";this.width=e,this.height=t,this.rowSize=e>>5,0!=(31&e)&&this.rowSize++,this.bits=new Array(this.rowSize*t);for(var n=0;n<this.bits.length;n++)this.bits[n]=0}return Object.defineProperty(e.prototype,"Width",{get:function(){return this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Height",{get:function(){return this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dimension",{get:function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width},enumerable:!0,configurable:!0}),e.prototype.URShift=function(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)},e.prototype.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&this.URShift(this.bits[n],31&e))},e.prototype.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},e.prototype.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},e.prototype.clear=function(){for(var e=this.bits.length,t=0;t<e;t++)this.bits[t]=0},e.prototype.setRegion=function(e,t,n,r){if(t<0||e<0)throw"Left and top must be nonnegative";if(r<1||n<1)throw"Height and width must be at least 1";var i=e+n,o=t+r;if(o>this.height||i>this.width)throw"The region must fit inside the matrix";for(var s=t;s<o;s++)for(var a=s*this.rowSize,h=e;h<i;h++)this.bits[a+(h>>5)]|=1<<(31&h)},e}(),s=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.checkAndNudgePoints=function(e,t){for(var n=this.width,r=this.height,i=!0,o=0;o<t.length&&i;o+=2){var s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>r)throw"Error.checkAndNudgePoints ";i=!1,-1==s?(t[o]=0,i=!0):s==n&&(t[o]=n-1,i=!0),-1==a?(t[o+1]=0,i=!0):a==r&&(t[o+1]=r-1,i=!0)}i=!0;for(o=t.length-2;o>=0&&i;o-=2){s=Math.floor(t[o]),a=Math.floor(t[o+1]);if(s<-1||s>n||a<-1||a>r)throw"Error.checkAndNudgePoints ";i=!1,-1==s?(t[o]=0,i=!0):s==n&&(t[o]=n-1,i=!0),-1==a?(t[o+1]=0,i=!0):a==r&&(t[o+1]=r-1,i=!0)}},e.prototype.sampleGrid3=function(e,t,n,r){for(var i=new o(n,n),s=new Array(n<<1),a=0;a<n;a++){for(var h=s.length,u=a+.5,f=0;f<h;f+=2)s[f]=.5+(f>>1),s[f+1]=u;r.transformPoints1(s),this.checkAndNudgePoints(e,s);try{for(f=0;f<h;f+=2){var w=4*Math.floor(s[f])+Math.floor(s[f+1])*this.width*4,c=e[Math.floor(s[f])+this.width*Math.floor(s[f+1])];t.data[w]=c?255:0,t.data[w+1]=c?255:0,t.data[w+2]=0,t.data[w+3]=255,c&&i.set_Renamed(f>>1,a)}}catch(l){throw"Error.checkAndNudgePoints"}}return i},e}(),a=function(){function e(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n}return e.forBits=function(e){if(e<0||e>=this.FOR_BITS.length)throw"ArgumentException";return this.FOR_BITS[e]},Object.defineProperty(e.prototype,"Bits",{get:function(){return this.bits},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this.name},enumerable:!0,configurable:!0}),e.prototype.ordinal=function(){return this.ordinal_Renamed_Field},e}();a.L=new a(0,1,"L"),a.M=new a(1,0,"M"),a.Q=new a(2,3,"Q"),a.H=new a(3,2,"H"),a.FOR_BITS=new Array(a.M,a.L,a.H,a.Q);var h=function(){function e(e){this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask},this.errorCorrectionLevel=a.forBits(e>>3&3),this.dataMask=7&e}return Object.defineProperty(e.prototype,"ErrorCorrectionLevel",{get:function(){return this.errorCorrectionLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DataMask",{get:function(){return this.dataMask},enumerable:!0,configurable:!0}),e.prototype.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask},e.URShift=function(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)},e.numBitsDiffering=function(t,n){return t^=n,e.BITS_SET_IN_HALF_BYTE[15&t]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,4)]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,8)]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,12)]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,16)]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,20)]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,24)]+e.BITS_SET_IN_HALF_BYTE[15&this.URShift(t,28)]},e.decodeFormatInformation=function(t){var n=this.doDecodeFormatInformation(t);return null!=n?n:this.doDecodeFormatInformation(t^e.FORMAT_INFO_MASK_QR)},e.doDecodeFormatInformation=function(t){for(var n=4294967295,r=0,i=0;i<e.FORMAT_INFO_DECODE_LOOKUP.length;i++){var o=e.FORMAT_INFO_DECODE_LOOKUP[i],s=o[0];if(s==t)return new e(o[1]);var a=e.numBitsDiffering(t,s);a<n&&(r=o[1],n=a)}return n<=3?new e(r):null},e.forBits=function(t){if(t<0||t>=e.FOR_BITS.length)throw"ArgumentException";return e.FOR_BITS[t]},e}();h.FORMAT_INFO_MASK_QR=21522,h.FORMAT_INFO_DECODE_LOOKUP=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),h.BITS_SET_IN_HALF_BYTE=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4),h.L=new a(0,1,"L"),h.M=new a(1,0,"M"),h.Q=new a(2,3,"Q"),h.H=new a(3,2,"H"),h.FOR_BITS=new Array(h.M,h.L,h.H,h.Q);var u=function(){function e(e,t){this.count=e,this.dataCodewords=t}return Object.defineProperty(e.prototype,"Count",{get:function(){return this.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DataCodewords",{get:function(){return this.dataCodewords},enumerable:!0,configurable:!0}),e}(),f=function(){function e(e,t,n){this.getECBlocks=function(){return this.ecBlocks},this.ecCodewordsPerBlock=e,this.ecBlocks=n?new Array(t,n):new Array(t)}return Object.defineProperty(e.prototype,"ECCodewordsPerBlock",{get:function(){return this.ecCodewordsPerBlock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalECCodewords",{get:function(){return this.ecCodewordsPerBlock*this.NumBlocks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"NumBlocks",{get:function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e},enumerable:!0,configurable:!0}),e}(),w=function(){function e(e,t,n,r,i,s){this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new o(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;r<n;r++)for(var i=this.alignmentPatternCenters[r]-2,s=0;s<n;s++)0==r&&(0==s||s==n-1)||r==n-1&&0==s||t.setRegion(this.alignmentPatternCenters[s]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]},this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(n,r,i,s);for(var a=0,h=n.ECCodewordsPerBlock,u=n.getECBlocks(),f=0;f<u.length;f++){var w=u[f];a+=w.Count*(w.DataCodewords+h)}this.totalCodewords=a}return Object.defineProperty(e.prototype,"VersionNumber",{get:function(){return this.versionNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AlignmentPatternCenters",{get:function(){return this.alignmentPatternCenters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalCodewords",{get:function(){return this.totalCodewords},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DimensionForVersion",{get:function(){return 17+4*this.versionNumber},enumerable:!0,configurable:!0}),e.getVersionForNumber=function(t){if(t<1||t>40)throw"ArgumentException";return e.VERSIONS[t-1]},e.getProvisionalVersionForDimension=function(t){if(t%4!=1)throw"Error getProvisionalVersionForDimension";try{return e.getVersionForNumber(t-17>>2)}catch(n){throw"Error getVersionForNumber"}},e.decodeVersionInformation=function(t){for(var n=4294967295,r=0,i=0;i<e.VERSION_DECODE_INFO.length;i++){var o=e.VERSION_DECODE_INFO[i];if(o==t)return this.getVersionForNumber(i+7);var s=h.numBitsDiffering(t,o);s<n&&(r=i+7,n=s)}return n<=3?this.getVersionForNumber(r):null},e.buildVersions=function(){return new Array(new e(1,new Array,new f(7,new u(1,19)),new f(10,new u(1,16)),new f(13,new u(1,13)),new f(17,new u(1,9))),new e(2,new Array(6,18),new f(10,new u(1,34)),new f(16,new u(1,28)),new f(22,new u(1,22)),new f(28,new u(1,16))),new e(3,new Array(6,22),new f(15,new u(1,55)),new f(26,new u(1,44)),new f(18,new u(2,17)),new f(22,new u(2,13))),new e(4,new Array(6,26),new f(20,new u(1,80)),new f(18,new u(2,32)),new f(26,new u(2,24)),new f(16,new u(4,9))),new e(5,new Array(6,30),new f(26,new u(1,108)),new f(24,new u(2,43)),new f(18,new u(2,15),new u(2,16)),new f(22,new u(2,11),new u(2,12))),new e(6,new Array(6,34),new f(18,new u(2,68)),new f(16,new u(4,27)),new f(24,new u(4,19)),new f(28,new u(4,15))),new e(7,new Array(6,22,38),new f(20,new u(2,78)),new f(18,new u(4,31)),new f(18,new u(2,14),new u(4,15)),new f(26,new u(4,13),new u(1,14))),new e(8,new Array(6,24,42),new f(24,new u(2,97)),new f(22,new u(2,38),new u(2,39)),new f(22,new u(4,18),new u(2,19)),new f(26,new u(4,14),new u(2,15))),new e(9,new Array(6,26,46),new f(30,new u(2,116)),new f(22,new u(3,36),new u(2,37)),new f(20,new u(4,16),new u(4,17)),new f(24,new u(4,12),new u(4,13))),new e(10,new Array(6,28,50),new f(18,new u(2,68),new u(2,69)),new f(26,new u(4,43),new u(1,44)),new f(24,new u(6,19),new u(2,20)),new f(28,new u(6,15),new u(2,16))),new e(11,new Array(6,30,54),new f(20,new u(4,81)),new f(30,new u(1,50),new u(4,51)),new f(28,new u(4,22),new u(4,23)),new f(24,new u(3,12),new u(8,13))),new e(12,new Array(6,32,58),new f(24,new u(2,92),new u(2,93)),new f(22,new u(6,36),new u(2,37)),new f(26,new u(4,20),new u(6,21)),new f(28,new u(7,14),new u(4,15))),new e(13,new Array(6,34,62),new f(26,new u(4,107)),new f(22,new u(8,37),new u(1,38)),new f(24,new u(8,20),new u(4,21)),new f(22,new u(12,11),new u(4,12))),new e(14,new Array(6,26,46,66),new f(30,new u(3,115),new u(1,116)),new f(24,new u(4,40),new u(5,41)),new f(20,new u(11,16),new u(5,17)),new f(24,new u(11,12),new u(5,13))),new e(15,new Array(6,26,48,70),new f(22,new u(5,87),new u(1,88)),new f(24,new u(5,41),new u(5,42)),new f(30,new u(5,24),new u(7,25)),new f(24,new u(11,12),new u(7,13))),new e(16,new Array(6,26,50,74),new f(24,new u(5,98),new u(1,99)),new f(28,new u(7,45),new u(3,46)),new f(24,new u(15,19),new u(2,20)),new f(30,new u(3,15),new u(13,16))),new e(17,new Array(6,30,54,78),new f(28,new u(1,107),new u(5,108)),new f(28,new u(10,46),new u(1,47)),new f(28,new u(1,22),new u(15,23)),new f(28,new u(2,14),new u(17,15))),new e(18,new Array(6,30,56,82),new f(30,new u(5,120),new u(1,121)),new f(26,new u(9,43),new u(4,44)),new f(28,new u(17,22),new u(1,23)),new f(28,new u(2,14),new u(19,15))),new e(19,new Array(6,30,58,86),new f(28,new u(3,113),new u(4,114)),new f(26,new u(3,44),new u(11,45)),new f(26,new u(17,21),new u(4,22)),new f(26,new u(9,13),new u(16,14))),new e(20,new Array(6,34,62,90),new f(28,new u(3,107),new u(5,108)),new f(26,new u(3,41),new u(13,42)),new f(30,new u(15,24),new u(5,25)),new f(28,new u(15,15),new u(10,16))),new e(21,new Array(6,28,50,72,94),new f(28,new u(4,116),new u(4,117)),new f(26,new u(17,42)),new f(28,new u(17,22),new u(6,23)),new f(30,new u(19,16),new u(6,17))),new e(22,new Array(6,26,50,74,98),new f(28,new u(2,111),new u(7,112)),new f(28,new u(17,46)),new f(30,new u(7,24),new u(16,25)),new f(24,new u(34,13))),new e(23,new Array(6,30,54,74,102),new f(30,new u(4,121),new u(5,122)),new f(28,new u(4,47),new u(14,48)),new f(30,new u(11,24),new u(14,25)),new f(30,new u(16,15),new u(14,16))),new e(24,new Array(6,28,54,80,106),new f(30,new u(6,117),new u(4,118)),new f(28,new u(6,45),new u(14,46)),new f(30,new u(11,24),new u(16,25)),new f(30,new u(30,16),new u(2,17))),new e(25,new Array(6,32,58,84,110),new f(26,new u(8,106),new u(4,107)),new f(28,new u(8,47),new u(13,48)),new f(30,new u(7,24),new u(22,25)),new f(30,new u(22,15),new u(13,16))),new e(26,new Array(6,30,58,86,114),new f(28,new u(10,114),new u(2,115)),new f(28,new u(19,46),new u(4,47)),new f(28,new u(28,22),new u(6,23)),new f(30,new u(33,16),new u(4,17))),new e(27,new Array(6,34,62,90,118),new f(30,new u(8,122),new u(4,123)),new f(28,new u(22,45),new u(3,46)),new f(30,new u(8,23),new u(26,24)),new f(30,new u(12,15),new u(28,16))),new e(28,new Array(6,26,50,74,98,122),new f(30,new u(3,117),new u(10,118)),new f(28,new u(3,45),new u(23,46)),new f(30,new u(4,24),new u(31,25)),new f(30,new u(11,15),new u(31,16))),new e(29,new Array(6,30,54,78,102,126),new f(30,new u(7,116),new u(7,117)),new f(28,new u(21,45),new u(7,46)),new f(30,new u(1,23),new u(37,24)),new f(30,new u(19,15),new u(26,16))),new e(30,new Array(6,26,52,78,104,130),new f(30,new u(5,115),new u(10,116)),new f(28,new u(19,47),new u(10,48)),new f(30,new u(15,24),new u(25,25)),new f(30,new u(23,15),new u(25,16))),new e(31,new Array(6,30,56,82,108,134),new f(30,new u(13,115),new u(3,116)),new f(28,new u(2,46),new u(29,47)),new f(30,new u(42,24),new u(1,25)),new f(30,new u(23,15),new u(28,16))),new e(32,new Array(6,34,60,86,112,138),new f(30,new u(17,115)),new f(28,new u(10,46),new u(23,47)),new f(30,new u(10,24),new u(35,25)),new f(30,new u(19,15),new u(35,16))),new e(33,new Array(6,30,58,86,114,142),new f(30,new u(17,115),new u(1,116)),new f(28,new u(14,46),new u(21,47)),new f(30,new u(29,24),new u(19,25)),new f(30,new u(11,15),new u(46,16))),new e(34,new Array(6,34,62,90,118,146),new f(30,new u(13,115),new u(6,116)),new f(28,new u(14,46),new u(23,47)),new f(30,new u(44,24),new u(7,25)),new f(30,new u(59,16),new u(1,17))),new e(35,new Array(6,30,54,78,102,126,150),new f(30,new u(12,121),new u(7,122)),new f(28,new u(12,47),new u(26,48)),new f(30,new u(39,24),new u(14,25)),new f(30,new u(22,15),new u(41,16))),new e(36,new Array(6,24,50,76,102,128,154),new f(30,new u(6,121),new u(14,122)),new f(28,new u(6,47),new u(34,48)),new f(30,new u(46,24),new u(10,25)),new f(30,new u(2,15),new u(64,16))),new e(37,new Array(6,28,54,80,106,132,158),new f(30,new u(17,122),new u(4,123)),new f(28,new u(29,46),new u(14,47)),new f(30,new u(49,24),new u(10,25)),new f(30,new u(24,15),new u(46,16))),new e(38,new Array(6,32,58,84,110,136,162),new f(30,new u(4,122),new u(18,123)),new f(28,new u(13,46),new u(32,47)),new f(30,new u(48,24),new u(14,25)),new f(30,new u(42,15),new u(32,16))),new e(39,new Array(6,26,54,82,110,138,166),new f(30,new u(20,117),new u(4,118)),new f(28,new u(40,47),new u(7,48)),new f(30,new u(43,24),new u(22,25)),new f(30,new u(10,15),new u(67,16))),new e(40,new Array(6,30,58,86,114,142,170),new f(30,new u(19,118),new u(6,119)),new f(28,new u(18,47),new u(31,48)),new f(30,new u(34,24),new u(34,25)),new f(30,new u(20,15),new u(61,16))))},e}();w.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),w.VERSIONS=w.buildVersions(),Array.prototype.remove||(Array.prototype.remove=function(e){var t=this.slice(e+1||this.length);return this.length=e<0?this.length+e:e,this.push.apply(this,t)});var c=function(){function e(e,t,n){this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return r<=1||r/this.estimatedModuleSize<=1}return!1},this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n}return Object.defineProperty(e.prototype,"EstimatedModuleSize",{get:function(){return this.estimatedModuleSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Count",{get:function(){return this.count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"X",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Y",{get:function(){return this.y},enumerable:!0,configurable:!0}),e}();c.MIN_SKIP=3,c.MAX_MODULES=57,c.INTEGER_MATH_SHIFT=8,c.CENTER_QUORUM=2;var l=function(){function e(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return Object.defineProperty(e.prototype,"BottomLeft",{get:function(){return this.bottomLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopLeft",{get:function(){return this.topLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TopRight",{get:function(){return this.topRight},enumerable:!0,configurable:!0}),e}(),d=function(){function e(e,t){this.possibleCenters=new Array,this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.orderBestPatterns=function(e){function t(e,t){var n=e.X-t.X,r=e.Y-t.Y;return Math.sqrt(n*n+r*r)}var n,r,i,o,s,a,h,u,f=t(e[0],e[1]),w=t(e[1],e[2]),c=t(e[0],e[2]);if(w>=f&&w>=c?(r=e[0],n=e[1],i=e[2]):c>=w&&c>=f?(r=e[1],n=e[0],i=e[2]):(r=e[2],n=e[0],i=e[1]),o=n,a=i,h=(s=r).x,u=s.y,(a.x-h)*(o.y-u)-(a.y-u)*(o.x-h)<0){var l=n;n=i,i=l}e[0]=n,e[1]=r,e[2]=i},this.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var r=e[n];if(0==r)return!1;t+=r}if(t<7)return!1;var i=Math.floor((t<<c.INTEGER_MATH_SHIFT)/7),o=Math.floor(i/2);return Math.abs(i-(e[0]<<c.INTEGER_MATH_SHIFT))<o&&Math.abs(i-(e[1]<<c.INTEGER_MATH_SHIFT))<o&&Math.abs(3*i-(e[2]<<c.INTEGER_MATH_SHIFT))<3*o&&Math.abs(i-(e[3]<<c.INTEGER_MATH_SHIFT))<o&&Math.abs(i-(e[4]<<c.INTEGER_MATH_SHIFT))<o},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,n,r){for(var i=this.image,o=this.height,s=this.CrossCheckStateCount,a=e;a>=0&&i[t+a*this.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i[t+a*this.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&i[t+a*this.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i[t+a*this.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!i[t+a*this.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&i[t+a*this.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var h=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(h-r)>=2*r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN},this.crossCheckHorizontal=function(e,t,n,r){for(var i=this.image,o=this.width,s=this.CrossCheckStateCount,a=e;a>=0&&i[a+t*this.width];)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i[a+t*this.width]&&s[1]<=n;)s[1]++,a--;if(a<0||s[1]>n)return NaN;for(;a>=0&&i[a+t*this.width]&&s[0]<=n;)s[0]++,a--;if(s[0]>n)return NaN;for(a=e+1;a<o&&i[a+t*this.width];)s[2]++,a++;if(a==o)return NaN;for(;a<o&&!i[a+t*this.width]&&s[3]<n;)s[3]++,a++;if(a==o||s[3]>=n)return NaN;for(;a<o&&i[a+t*this.width]&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return NaN;var h=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(h-r)>=r?NaN:this.foundPatternCross(s)?this.centerFromEnd(s,a):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),e[2],r);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],r),!isNaN(i))){for(var s=r/7,a=!1,h=this.possibleCenters.length,u=0;u<h;u++){var f=this.possibleCenters[u];if(f.aboutEquals(s,o,i)){f.incrementCount(),a=!0;break}}if(!a){var w=new c(i,o,s);this.possibleCenters.push(w),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(w)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(e<3)throw"Couldn't find enough finder patterns";if(e>3){for(var t=0,n=0,r=0;r<e;r++){var i=this.possibleCenters[r].EstimatedModuleSize;t+=i,n+=i*i}var o=t/e;this.possibleCenters.sort(function(e,t){var n=Math.abs(t.EstimatedModuleSize-o),r=Math.abs(e.EstimatedModuleSize-o);return n<r?-1:n==r?0:1});var s=Math.sqrt(n/e-o*o),a=Math.max(.2*o,s);for(r=this.possibleCenters.length-1;r>=0;r--){var h=this.possibleCenters[r];Math.abs(h.EstimatedModuleSize-o)>a&&this.possibleCenters.remove(r)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(e<=1)return 0;for(var t=null,n=0;n<e;n++){var r=this.possibleCenters[n];if(r.Count>=c.CENTER_QUORUM){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2);t=r}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;r<n;r++){var i=this.possibleCenters[r];i.Count>=c.CENTER_QUORUM&&(e++,t+=i.EstimatedModuleSize)}if(e<3)return!1;var o=t/n,s=0;for(r=0;r<n;r++)i=this.possibleCenters[r],s+=Math.abs(i.EstimatedModuleSize-o);return s<=.05*t},this.findFinderPattern=function(e){this.image=e;var t=this.height,n=this.width,r=Math.floor(3*t/(4*c.MAX_MODULES));r<c.MIN_SKIP&&(r=c.MIN_SKIP);for(var i=!1,o=new Array(5),s=r-1;s<t&&!i;s+=r){o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0;for(var a=0,h=0;h<n;h++)if(e[h+s*this.width])1==(1&a)&&a++,o[a]++;else if(0==(1&a))if(4==a)if(this.foundPatternCross(o)){if(this.handlePossibleCenter(o,s,h))if(r=2,this.hasSkipped)i=this.haveMultiplyConfirmedCenters();else{var u=this.findRowSkip();u>o[2]&&(s+=u-o[2]-r,h=n-1)}else{do{h++}while(h<n&&!e[h+s*this.width]);h--}a=0,o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0}else o[0]=o[2],o[1]=o[3],o[2]=o[4],o[3]=1,o[4]=0,a=3;else o[++a]++;else o[a]++;if(this.foundPatternCross(o))this.handlePossibleCenter(o,s,n)&&(r=o[0],this.hasSkipped&&(i=this.haveMultiplyConfirmedCenters()))}var f=this.selectBestPatterns();return this.orderBestPatterns(f),new l(f)},this.width=e,this.height=t}return Object.defineProperty(e.prototype,"CrossCheckStateCount",{get:function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount},enumerable:!0,configurable:!0}),e}(),p=function(){function e(t,n,r,i,o,s,a,h,u){this.transformPoints1=function(e){for(var t=e.length,n=this.a11,r=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,h=this.a31,u=this.a32,f=this.a33,w=0;w<t;w+=2){var c=e[w],l=e[w+1],d=i*c+a*l+f;e[w]=(n*c+o*l+h)/d,e[w+1]=(r*c+s*l+u)/d}},this.transformPoints2=function(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r],o=t[r],s=this.a13*i+this.a23*o+this.a33;e[r]=(this.a11*i+this.a21*o+this.a31)/s,t[r]=(this.a12*i+this.a22*o+this.a32)/s}},this.buildAdjoint=function(){return new e(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(t){return new e(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)},this.a11=t,this.a12=i,this.a13=a,this.a21=n,this.a22=o,this.a23=h,this.a31=r,this.a32=s,this.a33=u}return e.quadrilateralToQuadrilateral=function(e,t,n,r,i,o,s,a,h,u,f,w,c,l,d,p){var g=this.quadrilateralToSquare(e,t,n,r,i,o,s,a);return this.squareToQuadrilateral(h,u,f,w,c,l,d,p).times(g)},e.squareToQuadrilateral=function(t,n,r,i,o,s,a,h){var u=h-s,f=n-i+s-h;if(0==u&&0==f)return new e(r-t,o-r,t,i-n,s-i,n,0,0,1);var w=r-o,c=a-o,l=t-r+o-a,d=i-s,p=w*u-c*d,g=(l*u-c*f)/p,m=(w*f-l*d)/p;return new e(r-t+g*r,a-t+m*a,t,i-n+g*i,h-n+m*h,n,g,m,1)},e.quadrilateralToSquare=function(e,t,n,r,i,o,s,a){return this.squareToQuadrilateral(e,t,n,r,i,o,s,a).buildAdjoint()},e}(),g=function(){return function(e,t){this.bits=e,this.points=t}}(),m=function(){function e(e,t,n,r){this.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14},this.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},this.distance=function(e,t){var n=e.X-t.X,r=e.Y-t.Y;return Math.sqrt(n*n+r*r)},this.computeDimension=function(e,t,n,r){var i=7+(Math.round(this.distance(e,t)/r)+Math.round(this.distance(e,n)/r)>>1);switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw"Error"}return i},this.findAlignmentInRegion=function(e,t,n,r){var o=Math.floor(r*e),s=Math.max(0,t-o),a=Math.min(this.width-1,t+o);if(a-s<3*e)throw"Error";var h=Math.max(0,n-o),u=Math.min(this.height-1,n+o);return new i(this.image,s,h,a-s,u-h,e,this.width,this.height,this.resultPointCallback).find()},this.createTransform=function(e,t,n,r,i){var o,s,a,h,u=i-3.5;return null!=r?(o=r.X,s=r.Y,a=h=u-3):(o=t.X-e.X+n.X,s=t.Y-e.Y+n.Y,a=h=u),p.quadrilateralToQuadrilateral(3.5,3.5,u,3.5,a,h,3.5,u,e.X,e.Y,t.X,t.Y,o,s,n.X,n.Y)},this.sampleGrid=function(e,t,n){return new s(this.width,this.height).sampleGrid3(e,this.rawImage,n,t)},this.detect=function(){var e=new d(this.width,this.height).findFinderPattern(this.image);return this.processFinderPatternInfo(e)},this.image=e,this.rawImage=t,this.height=r,this.width=n}return e.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,r){var i=Math.abs(r-t)>Math.abs(n-e);if(i){var o=e;e=t,t=o,o=n,n=r,r=o}for(var s=Math.abs(n-e),a=Math.abs(r-t),h=-s>>1,u=t<r?1:-1,f=e<n?1:-1,w=0,c=e,l=t;c!=n;c+=f){var d=i?l:c,p=i?c:l;if(1==w?this.image[d+p*this.width]&&w++:this.image[d+p*this.width]||w++,3==w){var g=c-e,m=l-t;return Math.sqrt(g*g+m*m)}if((h+=a)>0){if(l==r)break;l+=u,h-=s}}var y=n-e,v=r-t;return Math.sqrt(y*y+v*v)},e.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,r){var i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),o=1,s=e-(n-e);s<0?(o=e/(e-s),s=0):s>=this.width&&(o=(this.width-1-e)/(s-e),s=this.width-1);var a=Math.floor(t-(r-t)*o);return o=1,a<0?(o=t/(t-a),a=0):a>=this.height&&(o=(this.height-1-t)/(a-t),a=this.height-1),s=Math.floor(e+(s-e)*o),(i+=this.sizeOfBlackWhiteBlackRun(e,t,s,a))-1},e.prototype.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,r=e.BottomLeft,i=this.calculateModuleSize(t,n,r);if(i<1)throw"Error";var o=this.computeDimension(t,n,r,i),s=w.getProvisionalVersionForDimension(o),a=s.DimensionForVersion-7,h=null;if(s.AlignmentPatternCenters.length>0)for(var u=n.X-t.X+r.X,f=n.Y-t.Y+r.Y,c=1-3/a,l=Math.floor(t.X+c*(u-t.X)),d=Math.floor(t.Y+c*(f-t.Y)),p=4;p<=16;p<<=1){h=this.findAlignmentInRegion(i,l,d,p);break}var m,y=this.createTransform(t,n,r,h,o),v=this.sampleGrid(this.image,y,o);return m=null==h?new Array(r,t,n):new Array(r,t,n,h),new g(v,m)},e}(),y=function(){function e(e,t){if(this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,r=e.getCoefficient(e.Degree),i=this.field.inverse(r);n.Degree>=e.Degree&&!n.Zero;){var o=n.Degree-e.Degree,s=this.field.multiply(n.getCoefficient(n.Degree),i),a=e.multiplyByMonomial(o,s),h=this.field.buildMonomial(o,s);t=t.addOrSubtract(h),n=n.addOrSubtract(a)}return new Array(t,n)},null==t||0==t.length)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&0==t[0]){for(var r=1;r<n&&0==t[r];)r++;if(r==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-r);for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=t[r+o]}}else this.coefficients=t}return Object.defineProperty(e.prototype,"Zero",{get:function(){return 0==this.coefficients[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Degree",{get:function(){return this.coefficients.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Coefficients",{get:function(){return this.coefficients},enumerable:!0,configurable:!0}),e.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},e.prototype.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var n=0,r=0;r<t;r++)n=v.addOrSubtract(n,this.coefficients[r]);return n}var i=this.coefficients[0];for(r=1;r<t;r++)i=v.addOrSubtract(this.field.multiply(e,i),this.coefficients[r]);return i},e.prototype.addOrSubtract=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return t;if(t.Zero)return this;var n=this.coefficients,r=t.coefficients;if(n.length>r.length){var i=n;n=r,r=i}for(var o=new Array(r.length),s=r.length-n.length,a=0;a<s;a++)o[a]=r[a];for(var h=s;h<r.length;h++)o[h]=v.addOrSubtract(n[h-s],r[h]);return new e(this.field,o)},e.prototype.multiply1=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||t.Zero)return this.field.Zero;for(var n=this.coefficients,r=n.length,i=t.coefficients,o=i.length,s=new Array(r+o-1),a=0;a<r;a++)for(var h=n[a],u=0;u<o;u++)s[a+u]=v.addOrSubtract(s[a+u],this.field.multiply(h,i[u]));return new e(this.field,s)},e.prototype.multiply2=function(t){if(0==t)return this.field.Zero;if(1==t)return this;for(var n=this.coefficients.length,r=new Array(n),i=0;i<n;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new e(this.field,r)},e.prototype.multiplyByMonomial=function(t,n){if(t<0)throw"System.ArgumentException";if(0==n)return this.field.Zero;for(var r=this.coefficients.length,i=new Array(r+t),o=0;o<i.length;o++)i[o]=0;for(o=0;o<r;o++)i[o]=this.field.multiply(this.coefficients[o],n);return new e(this.field,i)},e}(),v=function(){function e(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;n<256;n++)this.expTable[n]=t,(t<<=1)>=256&&(t^=e);for(n=0;n<255;n++)this.logTable[this.expTable[n]]=n;var r=new Array(1);r[0]=0,this.zero=new y(this,new Array(r));var i=new Array(1);i[0]=1,this.one=new y(this,new Array(i))}return Object.defineProperty(e.prototype,"Zero",{get:function(){return this.zero},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"One",{get:function(){return this.one},enumerable:!0,configurable:!0}),e.prototype.buildMonomial=function(e,t){if(e<0)throw"System.ArgumentException";if(0==t)return this.zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new y(this,n)},e.prototype.exp=function(e){return this.expTable[e]},e.prototype.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},e.prototype.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},e.prototype.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]},e.addOrSubtract=function(e,t){return e^t},e}();v.QR_CODE_FIELD=new v(285),v.DATA_MATRIX_FIELD=new v(301);var b=function(){function e(e){this.field=e}return e.prototype.decode=function(e,t){for(var n=new y(this.field,e),r=new Array(t),i=0;i<r.length;i++)r[i]=0;var o=!0;for(i=0;i<t;i++){var s=n.evaluateAt(this.field.exp(i));r[r.length-1-i]=s,0!=s&&(o=!1)}if(!o){var a=new y(this.field,r),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),a,t),u=h[0],f=h[1],w=this.findErrorLocations(u),c=this.findErrorMagnitudes(f,w,!1);for(i=0;i<w.length;i++){var l=e.length-1-this.field.log(w[i]);if(l<0)throw"ReedSolomonException Bad error location";e[l]=v.addOrSubtract(e[l],c[i])}}},e.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var r=e;e=t,t=r}for(var i=e,o=t,s=this.field.One,a=this.field.Zero,h=this.field.Zero,u=this.field.One;o.Degree>=Math.floor(n/2);){var f=i,w=s,c=h;if(s=a,h=u,(i=o).Zero)throw"r_{i-1} was zero";o=f;for(var l=this.field.Zero,d=i.getCoefficient(i.Degree),p=this.field.inverse(d);o.Degree>=i.Degree&&!o.Zero;){var g=o.Degree-i.Degree,m=this.field.multiply(o.getCoefficient(o.Degree),p);l=l.addOrSubtract(this.field.buildMonomial(g,m)),o=o.addOrSubtract(i.multiplyByMonomial(g,m))}a=l.multiply1(s).addOrSubtract(w),u=l.multiply1(h).addOrSubtract(c)}var y=u.getCoefficient(0);if(0==y)throw"ReedSolomonException sigmaTilde(0) was zero";var v=this.field.inverse(y),b=u.multiply2(v),C=o.multiply2(v);return new Array(b,C)},e.prototype.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var n=new Array(t),r=0,i=1;i<256&&r<t;i++)0==e.evaluateAt(i)&&(n[r]=this.field.inverse(i),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n},e.prototype.findErrorMagnitudes=function(e,t,n){for(var r=t.length,i=new Array(r),o=0;o<r;o++){for(var s=this.field.inverse(t[o]),a=1,h=0;h<r;h++)o!=h&&(a=this.field.multiply(a,v.addOrSubtract(1,this.field.multiply(t[h],s))));i[o]=this.field.multiply(e.evaluateAt(s),this.field.inverse(a)),n&&(i[o]=this.field.multiply(i[o],s))}return i},e}(),C=function(){function e(){this.isMasked=function(e,t){return 0==(e+t&1)}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),M=function(){function e(){this.isMasked=function(e,t){return 0==(1&e)}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),A=function(){function e(){this.isMasked=function(e,t){return t%3==0}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),S=function(){function e(){this.isMasked=function(e,t){return(e+t)%3==0}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),P=function(){function e(){this.isMasked=function(e,t){return 0==(this.URShift(e,1)+t/3&1)}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e.prototype.URShift=function(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)},e}(),E=function(){function e(){this.isMasked=function(e,t){var n=e*t;return(1&n)+n%3==0}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),k=function(){function e(){this.isMasked=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),N=function(){function e(){this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}return e.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)this.isMasked(n,r)&&e.flip(r,n)},e}(),T=function(){function e(){}return e.forReference=function(t){if(t<0||t>7)throw"System.ArgumentException";return e.DATA_MASKS[t]},e}();T.DATA_MASKS=new Array(new C,new M,new A,new S,new P,new E,new k,new N);var B=function(){function e(e){var t=e.Dimension;if(t<21||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e}return e.prototype.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1},e.prototype.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=h.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;var i=r-8;for(t=r-1;t>=i;t--)e=this.copyBit(t,8,e);for(n=r-7;n<r;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=h.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},e.prototype.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(t<=6)return w.getVersionForNumber(t);for(var n=0,r=e-11,i=5;i>=0;i--)for(var o=e-9;o>=r;o--)n=this.copyBit(o,i,n);if(this.parsedVersion=w.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;n=0;for(o=5;o>=0;o--)for(i=e-9;i>=r;i--)n=this.copyBit(o,i,n);if(this.parsedVersion=w.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},e.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=T.forReference(e.DataMask),r=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,r);for(var i=t.buildFunctionPattern(),o=!0,s=new Array(t.TotalCodewords),a=0,h=0,u=0,f=r-1;f>0;f-=2){6==f&&f--;for(var w=0;w<r;w++)for(var c=o?r-1-w:w,l=0;l<2;l++)i.get_Renamed(f-l,c)||(u++,h<<=1,this.bitMatrix.get_Renamed(f-l,c)&&(h|=1),8==u&&(s[a++]=h,u=0,h=0));o=!o}if(a!=t.TotalCodewords)throw"Error readCodewords";return s},e}(),O=function(){function e(e,t){this.numDataCodewords=e,this.codewords=t}return Object.defineProperty(e.prototype,"NumDataCodewords",{get:function(){return this.numDataCodewords},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Codewords",{get:function(){return this.codewords},enumerable:!0,configurable:!0}),e.getDataBlocks=function(t,n,r){if(t.length!=n.TotalCodewords)throw"ArgumentException";for(var i=n.getECBlocksForLevel(r),o=0,s=i.getECBlocks(),a=0;a<s.length;a++)o+=s[a].Count;for(var h=new Array(o),u=0,f=0;f<s.length;f++){var w=s[f];for(a=0;a<w.Count;a++){var c=w.DataCodewords,l=i.ECCodewordsPerBlock+c;h[u++]=new e(c,new Array(l))}}for(var d=h[0].codewords.length,p=h.length-1;p>=0;){if(h[p].codewords.length==d)break;p--}p++;var g=d-i.ECCodewordsPerBlock,m=0;for(a=0;a<g;a++)for(f=0;f<u;f++)h[f].codewords[a]=t[m++];for(f=p;f<u;f++)h[f].codewords[g]=t[m++];var y=h[0].codewords.length;for(a=g;a<y;a++)for(f=0;f<u;f++){var v=f<p?a:a+1;h[f].codewords[v]=t[m++]}return h},e}(),I=function(){function e(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,t<=9?this.dataLengthMode=0:t>=10&&t<=26?this.dataLengthMode=1:t>=27&&t<=40&&(this.dataLengthMode=2)}return e.prototype.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,r=0;r<e;r++)n+=1<<r;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){var i=0;for(r=0;r<this.bitPointer+1;r++)i+=1<<r;return t=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){i=0;var o=0;for(r=0;r<this.bitPointer+1;r++)i+=1<<r;var s=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1);this.blockPointer++;var a=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(r=0;r<e-(this.bitPointer+1+8);r++)o+=1<<r;return o<<=8-(e-(this.bitPointer+1+8)),t=s+a+((this.blocks[this.blockPointer]&o)>>8-(e-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},e.prototype.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},e.prototype.getDataLength=function(t){for(var n=0;t>>n!=1;)n++;return this.getNextBits(e.sizeOfDataLengthInfo[this.dataLengthMode][n])},e.prototype.getRomanAndFigureString=function(e){var t=e,n=0,r="",i=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){var o=(n=this.getNextBits(11))%45;r+=i[Math.floor(n/45)],r+=i[o],t-=2}else 1==t&&(r+=i[n=this.getNextBits(6)],t-=1)}while(t>0);return r},e.prototype.getFigureString=function(e){var t=e,n=0,r="";do{t>=3?((n=this.getNextBits(10))<100&&(r+="0"),n<10&&(r+="0"),t-=3):2==t?((n=this.getNextBits(7))<10&&(r+="0"),t-=2):1==t&&(n=this.getNextBits(4),t-=1),r+=n}while(t>0);return r},e.prototype.get8bitByteArray=function(e){var t=e,n=0,r=new Array;do{n=this.getNextBits(8),r.push(n),t--}while(t>0);return r},e.prototype.getKanjiString=function(e){var t=e,n=0,r="";do{var i=((n=this.getNextBits(13))/192<<8)+n%192,o=0;o=i+33088<=40956?i+33088:i+49472,r+=String.fromCharCode(o),t--}while(t>0);return r},Object.defineProperty(e.prototype,"DataByte",{get:function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t)throw"Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";var n=this.getDataLength(t);if(n<1)throw"Invalid data length: "+n;switch(t){case 1:for(var r=this.getFigureString(n),i=new Array(r.length),o=0;o<r.length;o++)i[o]=r.charCodeAt(o);e.push(i);break;case 2:for(r=this.getRomanAndFigureString(n),i=new Array(r.length),o=0;o<r.length;o++)i[o]=r.charCodeAt(o);e.push(i);break;case 4:var s=this.get8bitByteArray(n);e.push(s);break;case 8:r=this.getKanjiString(n);e.push(r)}}return e},enumerable:!0,configurable:!0}),e}();I.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]];var D=function(){function e(){this.rsDecoder=new b(v.QR_CODE_FIELD),this.decode=function(e){for(var t=new B(e),n=t.readVersion(),r=t.readFormatInformation().ErrorCorrectionLevel,i=t.readCodewords(),o=O.getDataBlocks(i,n,r),s=0,a=0;a<o.length;a++)s+=o[a].NumDataCodewords;for(var h=new Array(s),u=0,f=0;f<o.length;f++){var w=o[f],c=w.Codewords,l=w.NumDataCodewords;this.correctErrors(c,l);for(a=0;a<l;a++)h[u++]=c[a]}return new I(h,n.VersionNumber,r.Bits)}}return e.prototype.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++)r[i]=255&e[i];var o=e.length-t;try{this.rsDecoder.decode(r,o)}catch(s){throw s}for(i=0;i<t;i++)e[i]=r[i]},e}(),_=function(){function e(){this.debug=!1,this.maxImgSize=1048576,this.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]]}return e.prototype.decode=function(e){var t=e.getContext("2d");return this.width=e.width,this.height=e.height,this.imagedata=t.getImageData(0,0,this.width,this.height),this.result=this.process(t),null!=this.myCallback&&this.myCallback(this.result),this.result},e.prototype.process=function(e){var t=(new Date).getTime(),n=this.grayScaleToBitmap(this.grayscale());if(this.debug){for(var r=0;r<this.height;r++)for(var i=0;i<this.width;i++){var o=4*i+r*this.width*4;this.imagedata.data[o]=(n[i+r*this.width],0),this.imagedata.data[o+1]=(n[i+r*this.width],0),this.imagedata.data[o+2]=n[i+r*this.width]?255:0}e.putImageData(this.imagedata,0,0)}var s=new m(n,this.imagedata,this.width,this.height).detect();this.debug&&e.putImageData(this.imagedata,0,0);for(var a=(new D).decode(s.bits).DataByte,h="",u=0;u<a.length;u++)for(var f=0;f<a[u].length;f++)h+=String.fromCharCode(a[u][f]);var w=(new Date).getTime()-t;return console.log(w),h},e.prototype.grayScaleToBitmap=function(e){for(var t=this.getMiddleBrightnessPerArea(e),n=t.length,r=Math.floor(this.width/n),i=Math.floor(this.height/n),o=new Array(this.height*this.width),s=0;s<n;s++)for(var a=0;a<n;a++)for(var h=0;h<i;h++)for(var u=0;u<r;u++)o[r*a+u+(i*s+h)*this.width]=e[r*a+u+(i*s+h)*this.width]<t[a][s];return o},e.prototype.grayscale=function(){for(var e=new Array(this.width*this.height),t=0;t<this.height;t++)for(var n=0;n<this.width;n++){var r=this.getPixel(n,t);e[n+t*this.width]=r}return e},e.prototype.getPixel=function(e,t){if(this.width<e)throw"point error";if(this.height<t)throw"point error";var n=4*e+t*this.width*4;return(33*this.imagedata.data[n]+34*this.imagedata.data[n+1]+33*this.imagedata.data[n+2])/100},e.prototype.getMiddleBrightnessPerArea=function(e){for(var t=Math.floor(this.width/4),n=Math.floor(this.height/4),r=new Array(4),i=0;i<4;i++){r[i]=new Array(4);for(var o=0;o<4;o++)r[i][o]=new Array(0,0)}for(var s=0;s<4;s++)for(var a=0;a<4;a++){r[a][s][0]=255;for(var h=0;h<n;h++)for(var u=0;u<t;u++){var f=e[t*a+u+(n*s+h)*this.width];f<r[a][s][0]&&(r[a][s][0]=f),f>r[a][s][1]&&(r[a][s][1]=f)}}for(var w=new Array(4),c=0;c<4;c++)w[c]=new Array(4);for(s=0;s<4;s++)for(a=0;a<4;a++)w[a][s]=Math.floor((r[a][s][0]+r[a][s][1])/2);return w},e}(),F=function(){function e(e,n){this.renderer=e,this.element=n,this.canvasWidth=640,this.canvasHeight=480,this.facing="environment",this.debug=!1,this.mirror=!1,this.stopAfterScan=!0,this.updateTime=500,this.onRead=new t.EventEmitter,this.qrCode=null,this.isDeviceConnected=!1,this.gUM=!1,this.isWebkit=!1,this.isMoz=!1,this.stop=!1,this.supported=!0,this.nativeElement=this.element.nativeElement,this.supported=this.isCanvasSupported()}return e.prototype.ngOnInit=function(){this.debug&&console.log("[QrScanner] QR Scanner init, facing "+this.facing)},e.prototype.ngAfterViewInit=function(){this.load()},e.prototype.ngOnDestroy=function(){this.stopScanning()},e.prototype.startScanning=function(){this.load()},e.prototype.stopScanning=function(){this.captureTimeout&&(clearTimeout(this.captureTimeout),this.captureTimeout=!1),this.stream.getTracks()[0].stop(),this.stop=!0},e.prototype.isCanvasSupported=function(){var e=this.renderer.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},e.prototype.initCanvas=function(e,t){this.qrCanvas.nativeElement.style.width=e+"px",this.qrCanvas.nativeElement.style.height=t+"px",this.gCtx=this.qrCanvas.nativeElement.getContext("2d"),this.gCtx.clearRect(0,0,e,t),this.mirror||this.gCtx.translate(-1,1)},e.prototype.connectDevice=function(e){var t=this;function n(e){if(t.stream=e,t.isWebkit||t.isMoz)try{t.videoElement.src=window.URL.createObjectURL(e)}catch(r){t.videoElement.srcObject=e}else t.videoElement.src=e;t.gUM=!0,t.captureTimeout=setTimeout(i,t.updateTime)}function r(){t.gUM=!1}function i(){if(!t.stop&&t.isDeviceConnected&&t.gUM)try{t.gCtx.drawImage(t.videoElement,0,0,t.canvasWidth,t.canvasHeight),t.qrCode.decode(t.qrCanvas.nativeElement)}catch(e){this.debug&&console.log(e),t.captureTimeout=setTimeout(i,t.updateTime)}}if(!this.isDeviceConnected||this.captureTimeout){var o=navigator;this.videoElement||(this.videoElement=this.renderer.createElement("video"),this.videoElement.setAttribute("autoplay","true"),this.renderer.appendChild(this.videoWrapper.nativeElement,this.videoElement)),this.mirror||this.videoElement.classList.add("mirrored"),o.getUserMedia?(this.isWebkit=!0,o.getUserMedia({video:e,audio:!1},n,r)):o.webkitGetUserMedia?(this.isWebkit=!0,o.webkitGetUserMedia({video:e,audio:!1},n,r)):o.mozGetUserMedia&&(this.isMoz=!0,o.mozGetUserMedia({video:e,audio:!1},n,r)),this.isDeviceConnected=!0,this.captureTimeout=setTimeout(i,this.updateTime)}else this.captureTimeout=setTimeout(i,this.updateTime)},Object.defineProperty(e.prototype,"findMediaDevices",{get:function(){var e=this;return new Promise(function(t,n){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then(function(n){var r=n.find(function(e){return"videoinput"===(t=e).kind&&t.label.search(/back/i)>-1;var t});t(!r||{deviceId:{exact:r.deviceId},facingMode:e.facing})})}catch(r){e.debug&&console.log(r),n(r)}else e.debug&&console.log("[QrScanner] no navigator.mediaDevices.enumerateDevices"),t(!0)})},enumerable:!0,configurable:!0}),e.prototype.decodeCallback=function(e){this.onRead.emit(e),this.stopAfterScan&&this.stopScanning()},e.prototype.load=function(){var e=this;this.stop=!1,this.isDeviceConnected=!1,this.supported&&(this.initCanvas(this.canvasHeight,this.canvasWidth),this.qrCode=new _,this.qrCode.myCallback=function(t){return e.decodeCallback(t)},this.findMediaDevices.then(function(t){return e.connectDevice(t)}))},e}();F.decorators=[{type:t.Component,args:[{moduleId:"module.id",selector:"qr-scanner",styles:[":host video {height: auto; width: 100%;}",":host .mirrored { transform: rotateY(180deg); -webkit-transform:rotateY(180deg); -moz-transform:rotateY(180deg); }"],template:'\n        <ng-container [ngSwitch]="supported">\n            <ng-container *ngSwitchDefault>\n                <canvas #qrCanvas [width]="canvasWidth" [height]="canvasHeight" hidden="true"></canvas>\n                <div #videoWrapper></div>\n            </ng-container>\n            <ng-container *ngSwitchCase="false">\n                <p>\n                    You are using an <strong>outdated</strong> browser.\n                    Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.\n                </p>\n            </ng-container>\n        </ng-container>'}]}],F.ctorParameters=function(){return[{type:t.Renderer2},{type:t.ElementRef}]},F.propDecorators={canvasWidth:[{type:t.Input}],canvasHeight:[{type:t.Input}],facing:[{type:t.Input}],debug:[{type:t.Input}],mirror:[{type:t.Input}],stopAfterScan:[{type:t.Input}],updateTime:[{type:t.Input}],onRead:[{type:t.Output}],videoWrapper:[{type:t.ViewChild,args:["videoWrapper"]}],qrCanvas:[{type:t.ViewChild,args:["qrCanvas"]}]};var R=function(){function e(){}return e.forRoot=function(){return{ngModule:e}},e}();R.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule],declarations:[F],exports:[F]}]}],R.ctorParameters=function(){return[]},e.QrScannerComponent=F,e.QrScannerModule=R,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angular2-qrscanner.umd.min.js.map
